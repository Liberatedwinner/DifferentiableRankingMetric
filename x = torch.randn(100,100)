x = torch.randn(100,100)
with torch.autograd.profiler.profile() as prof:
    for i in range(1000):
        t = torch.polygamma(1, x)


print(prof.key_averages().table())


torch.cuda.synchronize()
x = torch.randn(100,100).cuda()
with torch.autograd.profiler.profile(use_cuda=True) as prof:
    for i in range(1000):
        t = torch.polygamma(1, x)


print(prof.key_averages().table())
